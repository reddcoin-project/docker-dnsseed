reddcoincore/dnsseed
=============

[![Build Status]][builds]
[![gh_last_release_svg]][gh_last_release_url]
[![Docker Image Size]][lnd-docker-hub]
[![Docker Pulls Count]][lnd-docker-hub]

[Build Status]: https://github.com/reddcoin-project/docker-dnsseed/workflows/Build%20&%20deploy%20on%20git%20tag%20push/badge.svg
[builds]: https://github.com/reddcoin-project/docker-dnsseed/actions?query=workflow%3A%22Build+%26+deploy+on+git+tag+push%22

[gh_last_release_svg]: https://img.shields.io/github/v/release/reddcoin-project/docker-dnsseed?sort=semver
[gh_last_release_url]: https://github.com/reddcoin-project/docker-dnsseed/releases/latest

[Docker Image Size]: https://img.shields.io/docker/image-size/reddcoincore/dnsseed
[Docker Pulls Count]: https://img.shields.io/docker/pulls/reddcoincore/dnsseed.svg?style=flat
[lnd-docker-hub]: https://hub.docker.com/repositories/reddcoincore/dnsseed


This repo builds [`dnsseed`] in an [auditable way](https://github.com/reddcoin-project/docker-dnsseed), and packages it into a minimal Docker containers provided for various CPU architectures.

[`dnsseed`]: https://github.com/reddcoin-project/reddcoin-dnsseed


> The work here was initially based on [lncm/docker-bitcoind](https://github.com/lncm/docker-bitcoind) and [ruimarinho/docker-bitcoin-core](https://github.com/ruimarinho/docker-bitcoin-core/), but has significantly diverged since.


#### Details

* **All [`git-tags`]** <small>(and most commits)</small> **are signed** by `ABEDC4489B9188E45C2342A82E91240B293BA5D3`
* **All [`git-tags`]** <small>(and most commits)</small> **are [`opentimestamps`]-ed**
* **All builds aim to be maximally auditable.**  After `git tag push`, the entire process is automated, with each step printed, and the code aiming to be easy to follow
* All builds are based on [Debian]
* Cross-compiled builds are done using our (also auditable) [`qemu`]
* Each build produces binaries for: `amd64`, `arm64v8`, and `arm32v7`
* All architectures are aggregated under an easy-to-use [Docker Manifest]
* All [`git-tags`] are [build automatically], and with an [auditable trace]
* Each successful build of a `git tag` pushes result Docker image to [Docker Hub]
* Images pushed to Docker Hub are never deleted (even if `lnd` version gets overridden, previous one is preserved)
* All `final` images are based on Debian for minimum base size
* Each `git-tag` build is tagged with a unique tag number
* Each _minor_ version is stored in a separate directory (for the ease of backporting patches)


[`git-tags`]: https://github.com/lncm/docker-lnd/tags
[`opentimestamps`]: https://github.com/opentimestamps/opentimestamps-client/blob/master/doc/git-integration.md#usage
[Alpine]: https://github.com/reddcoin-project/docker-dnsseed/blob/master/0.03/Dockerfile#L6
[`qemu`]: https://github.com/meeDamian/simple-qemu
[Docker Manifest]: https://github.com/reddcoin-project/docker-dnsseed/blob/master/.github/workflows/on-tag.yml#L171-L187
[build automatically]: https://github.com/reddcoin-project/docker-dnsseed/blob/master/.github/workflows/on-tag.yml
[auditable trace]: https://github.com/reddcoin-project/docker-dnsseed/actions/runs/9950306520?check_suite_focus=true
[Docker Hub]: https://github.com/reddcoin-project/docker-dnsseed/blob/master/.github/workflows/on-tag.yml#L168-L169
[Github Releases]: https://github.com/reddcoin-project/docker-dnsseed/blob/master/.github/workflows/on-tag.yml#L194-L195


## Tags

> **NOTE:** For an always up-to-date list see: https://hub.docker.com/repository/docker/reddcoincore/dnsseed/tags

* `v0.04`
* `v0.03`
* `v0.01`


## Usage

### Pull

First pull the image from [Docker Hub]:

```bash
docker pull reddcoincore/dnsseed:v0.04
```

> **NOTE:** Running above will automatically choose native architecture of your CPU.

[Docker Hub]: https://hub.docker.com/repository/docker/reddcoincore/dnsseed

Or, to pull a specific CPU architecture:

```bash
docker pull reddcoincore/dnsseed:v0.3
```

#### Start

First of all, create a directory in your home directory called `dnsseed`

Then to start dnsseed, run:

```bash
docker run  -it  --rm  --detach \
    -v ./dnsseed:/src \
    -p 53:53 \
    --name dnsseed \
    reddcoincore/dnsseed:v0.04
```

That will run dnsseed such that:

* all data generated by the container is stored in `~/dnsseed` **on your host machine**,
* port `53` will be reachable for the dns communication,
* created container will get named `dnsseed`,
* that command will run the container in the background and print the ID of the container being run.



### Docker Compose
Here is a docker-compose.yml
```yaml
services:
  reddcoin-seeder:
    container_name: dnsseed
    image: reddcoincore/dnsseed:v0.04
    command: dnsseed -h dnsseed.example.com -n vps.example.com -p 53
    restart: on-failure
    volumes:
      - ./dnsseed:/src
    ports:
      - 53:53/udp
```
First, ensure that the `./dnsseed/` folder is in the directory containing docker-compose.yml.
Then, Docker Compose will mount the `./dnsseed/` folder to `/src`.

